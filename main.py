import numpy as np
from sklearn.ensemble import RandomForestRegressor


jnd_data = [
    np.array([0.8, 0.8, 0.8, 1, 1, 1, 1, 0.8, 0.8, 0.8, 0.85]),
    np.array([0.4, 0.4, 0.4, 0.4, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.4, 0.4, 0.4, 0.4, 0.4, 0.5, 0.5]),
    np.array([1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 1.733, 0.333, 0.333, 0.333, 0.433, 0.433, 0.383]),
    np.array([0.914, 0.914, 0.914, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 1.114, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.214, 0.514, 0.514]),
    np.array([0.001, 0.001, 0.001, 0.201, 0.201, 0.201, 0.101, 0.101, 0.101, 0.151, 0.151]),
    np.array([0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.801, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 0.701, 1.101, 1.101]),
    np.array([0.001, 0.001, 0.001, 0.201, 0.201, 0.201, 0.101, 0.101, 0.101, 0.151, 0.151]),
    np.array([0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.8, 0.7, 0.7, 0.7, 0.75, 0.75]),
    np.array([0.001, 0.001, 0.001, 0.001, 0.401, 0.401, 0.401, 0.401, 0.201, 0.201, 0.201, 0.251, 0.251]),
    np.array([0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.401, 0.401, 0.401, 0.401, 0.401, 0.401, 0.201, 0.201, 0.201, 0.201, 0.201, 0.201, 0.401, 0.401, 0.401]),
    np.array([1.6, 1.2, 0.8, 0.4, 0.6, 0.6, 0.6, 0.5, 0.5, 0.5, 0.4, 0.4, 0.5, 0.5, 0.5, 0.45, 0.45, 0.45, 0.4, 0.4, 0.4, 0.35, 0.35, 0.35, 0.3, 0.3, 0.3]),
    np.array([1.6, 1.2, 0.8, 0.4, 0.001, 0.001, 0.201, 0.401, 0.401, 0.401, 0.301, 0.401, 0.401, 0.401, 0.351, 0.351, 0.351]),
    np.array([1.6, 1.2, 0.8, 0.4, 0.001, 0.201, 0.201, 0.201, 0.101, 0.101, 0.201, 0.201, 0.301, 0.301, 0.301, 0.251, 0.251, 0.251, 0.251]),
    np.array([1.6, 1.2, 1.4, 1.4, 1.6, 1.6, 1.6, 1.5, 1.5, 1.5, 1.4, 1.4, 1.4, 1.3, 1.3, 1.3, 1.2, 1.3, 1.3, 1.3, 1.25, 1.25, 1.25, 1.2, 1.2]),
    np.array([1.6, 1.2, 0.8, 0.4, 0.001, 0.001, 0.201, 0.401, 0.401, 0.401, 0.301, 0.301, 0.301, 0.201, 0.301, 0.401, 0.401, 0.401, 0.351, 0.351]),
    np.array([1.6, 1.2, 0.8, 0.4, 0.001, 0.001, 0.201, 0.401, 0.401, 0.601, 0.601, 0.601, 0.501, 0.501, 0.501, 0.401, 0.401, 0.401, 0.301, 0.401, 0.401, 0.401, 0.351, 0.351, 0.351])
]


for participant_data in jnd_data:
    model = RandomForestRegressor()
    for i in range(len(participant_data) - 1):
        X_train = participant_data[i:-1].reshape(-1, 1)
        y_train = participant_data[i + 1:]
        model.fit(X_train, y_train)


        next_jnd = model.predict(X_train[-1].reshape(1, -1))
        print("Participant data:", participant_data)
        print("Next JND prediction for iteration", i + 1, ":", next_jnd[0])
        print()



















































































































